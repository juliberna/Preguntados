{{> navbar }}
<main class="container mt-4">
    <h2>Pregunta</h2>

    <div class="card p-3 mb-3" style="background-color: #f8f9fa;">
        <p><strong>Categoría:</strong> {{categoria.nombre}}</p>
        <p>{{pregunta.pregunta}}</p>
    </div>

    <div id="timer" class="alert alert-info">
        Tiempo restante: <span id="tiempo-restante">…</span> segundos
    </div>

    <div class="respuestas d-grid gap-2">
        {{#respuestas}}
            <a href="/pregunta/responder?idRespuesta={{id_respuesta}}"
            class="btn btn-outline-primary btn-lg">
            {{respuesta}}
            </a>
        {{/respuestas}}
    </div>
</main>

<!-- Script para el timer -->
<script>
    const timerEl = document.getElementById('tiempo-restante');

    async function refrescarTimer() {
        try {
            const res = await fetch('/pregunta/tiempoRestante', {cache: 'no-store'});
            const {segundos} = await res.json();
            timerEl.textContent = segundos;
            if (segundos <= 0) {
                alert('Se acabó el tiempo para responder. La partida terminará.');
                return window.location.href = "/partida/finalizarPartida";
            }
        } catch (e) {
            console.error('Error al refrescar timer', e);
        }
    }

    // Primera llamada e intervalo cada 1 000 ms
    refrescarTimer();
    setInterval(refrescarTimer, 1000);
</script>